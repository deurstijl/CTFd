import"../main.min.js";import{d as h}from"../../utils.min.js";import{C as s}from"../../core.min.js";import{e as v,a as b,b as y}from"../../ezq.min.js";import{$ as t}from"../../jquery.min.js";import"../../styles.min.js";import"../../index.min.js";import"../../_commonjsHelpers.min.js";import"../../dayjs.min.min.js";import"../../times.min.js";import"../../events.min.js";import"../../config.min.js";import"../../helpers.min.js";import"../../patch.min.js";import"../../api.min.js";import"../../fetch.min.js";t(()=>{window.team_captain&&(t(".edit-team").click(function(){t("#team-edit-modal").modal()}),t(".edit-captain").click(function(){t("#team-captain-modal").modal()}),t(".invite-members").click(function(){s.fetch("/api/v1/teams/me/members",{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){if(e.success){let a=e.data.code,o=`${window.location.origin}${s.config.urlRoot}/teams/invite?code=${a}`;t("#team-invite-modal input[name=link]").val(o),t("#team-invite-modal").modal()}})}),t("#team-invite-link-copy").click(function(e){h(e,"#team-invite-link")}),t(".disband-team").click(function(){v({title:"Disband Team",body:"Are you sure you want to disband your team?",success:function(){s.fetch("/api/v1/teams/me",{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){e.success?window.location.reload():b({title:"Error",body:e.errors[""].join(" "),button:"Got it!"})})}})}));let m=t("#team-info-form");m.submit(function(e){e.preventDefault(),t("#results").empty();let a=t(this).serializeJSON();a.fields=[];for(const n in a)if(n.match(/fields\[\d+\]/)){let i={},r=parseInt(n.slice(7,-1));i.field_id=r,i.value=a[n],a.fields.push(i),delete a[n]}s.fetch("/api/v1/teams/me",{method:"PATCH",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(n){n.status===400?n.json().then(function(i){if(!i.success){const r=`<div class="alert alert-danger alert-dismissable" role="alert">
  <span class="visually-hidden">Error:</span>
  {0}
  <button type="button" class="close btn-close position-absolute p-3 end-0" data-bs-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
</div>`;Object.keys(i.errors).map(function(c){let p=m.find("input[name={0}]".format(c)),d=t(p);d.addClass("input-filled-invalid"),d.removeClass("input-filled-valid");let f=i.errors[c],u=r.format(f);t("#results").append(u)})}}):n.status===200&&n.json().then(function(i){i.success&&window.location.reload()})})}),t("#team-captain-form").submit(function(e){e.preventDefault();var a=t("#team-captain-form").serializeJSON(!0);s.fetch("/api/v1/teams/me",{method:"PATCH",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(o){return o.json()}).then(function(o){o.success?window.location.reload():(t("#team-captain-form > #results").empty(),Object.keys(o.errors).forEach(function(l,n){t("#team-captain-form > #results").append(y({type:"error",body:o.errors[l]}));var i=t("#team-captain-form").find("select[name={0}]".format(l)),r=t(i);r.addClass("input-filled-invalid"),r.removeClass("input-filled-valid")}))})})});
