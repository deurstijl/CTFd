import"./main.min.js";import{$ as i}from"../jquery.min.js";import{C as n}from"../core.min.js";import{i as u}from"../index.min2.js";import{d as x}from"../dayjs.min.min.js";import{h as v,a as w,b as _}from"../utils.min.js";import"../styles.min.js";import"../index.min.js";import"../_commonjsHelpers.min.js";import"../times.min.js";import"../events.min.js";import"../config.min.js";import"../helpers.min.js";import"../ezq.min.js";import"../patch.min.js";import"../api.min.js";import"../fetch.min.js";const m=i("#score-graph"),d=i("#scoreboard tbody"),S=()=>{n.api.get_scoreboard_list().then(r=>{const t=r.data;d.empty();for(let e=0;e<t.length;e++){const s=["<tr>",'<th scope="row" class="text-center">',e+1,"</th>",'<td><a href="{0}/teams/{1}">'.format(n.config.urlRoot,t[e].account_id),v(t[e].name),"</a></td>","<td>",t[e].score,"</td>","</tr>"].join("");d.append(s)}})},h=()=>n.api.get_scoreboard_detail({count:10}).then(r=>{const t=r.data,e=Object.keys(t);if(e.length===0)return!1;const s={title:{left:"center",text:"Top 10 "+(n.config.userMode==="teams"?"Teams":"Users")},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{type:"scroll",orient:"horizontal",align:"left",bottom:35,data:[]},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},saveAsImage:{}}},grid:{containLabel:!0},xAxis:[{type:"time",boundaryGap:!1,data:[]}],yAxis:[{type:"value"}],dataZoom:[{id:"dataZoomX",type:"slider",xAxisIndex:[0],filterMode:"filter",height:20,top:35,fillerColor:"rgba(233, 236, 241, 0.4)"}],series:[]};for(let o=0;o<e.length;o++){const c=[],p=[];for(let a=0;a<t[e[o]].solves.length;a++){c.push(t[e[o]].solves[a].value);const l=x(t[e[o]].solves[a].date);p.push(l.toDate())}const y=w(c);var g=p.map(function(a,l){return[a,y[l]]});s.legend.data.push(t[e[o]].name);const b={name:t[e[o]].name,type:"line",label:{normal:{position:"top"}},itemStyle:{normal:{color:_(t[e[o]].name+t[e[o]].id)}},data:g};s.series.push(b)}return s}),j=()=>{h().then(r=>{if(r===!1){m.html('<h3 class="opacity-50 text-center w-100 justify-content-center align-self-center">No solves yet</h3>');return}m.empty();let t=u(document.querySelector("#score-graph"));t.setOption(r),i(window).on("resize",function(){t!=null&&t!=null&&t.resize()})})},A=()=>{h().then(r=>{u(document.querySelector("#score-graph")).setOption(r)})};function f(){S(),A()}i(()=>{setInterval(f,3e5),j()});window.updateScoreboard=f;
