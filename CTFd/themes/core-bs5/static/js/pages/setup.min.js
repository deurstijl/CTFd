import"./main.min.js";import{$ as e}from"../jquery.min.js";import{d as c}from"../dayjs.min.min.js";import{C as r}from"../core.min.js";import"../styles.min.js";import"../index.min.js";import"../_commonjsHelpers.min.js";import"../times.min.js";import"../events.min.js";import"../utils.min.js";import"../config.min.js";import"../helpers.min.js";import"../ezq.min.js";import"../patch.min.js";import"../api.min.js";import"../fetch.min.js";function f(t){t.preventDefault();let i=!0;if(e(t.target).closest("[role=tabpanel]").find("input,textarea").each(function(n,a){let l=e(a);a.checkValidity()===!1&&(l.removeClass("input-filled-valid"),l.addClass("input-filled-invalid"),i=!1)}),i==!1)return;let o=e(t.target).data("href");e(`.nav a[href="${o}"]`).tab("show")}function s(t){return function(i){let o=e(`#${t}-date`),n=e(`#${t}-time`),a=c(`${o.val()} ${n.val()}`,"YYYY-MM-DD HH:mm").unix();isNaN(a)?e(`#${t}-preview`).val(""):e(`#${t}-preview`).val(a)}}function u(t){let i={name:e("#ctf_name").val(),type:"jeopardy",description:e("#ctf_description").val(),user_mode:e("#user_mode").val(),event_url:window.location.origin+r.config.urlRoot,redirect_url:window.location.origin+r.config.urlRoot+"/redirect",integration_setup_url:window.location.origin+r.config.urlRoot+"/setup/integrations",start:e("#start-preview").val(),end:e("#end-preview").val(),platform:"CTFd",state:window.STATE};const o=[];for(let n in i)o.push(encodeURIComponent(n)+"="+encodeURIComponent(i[n]));window.open("https://www.majorleaguecyber.org/events/new?"+o.join("&"),"_blank")}e(()=>{e(".tab-next").click(f),e("input").on("keypress",function(t){t.keyCode==13&&(t.preventDefault(),e(t.target).closest(".tab-pane").find("button[data-href]").click())}),e("#integration-mlc").click(u),e("#start-date,#start-time").change(s("start")),e("#end-date,#end-time").change(s("end")),e("#config-color-picker").on("input",function(t){e("#config-color-input").val(e(this).val())}),e("#config-color-reset").click(function(){e("#config-color-input").val(""),e("#config-color-picker").val("")}),e("#ctf_logo").on("change",function(){this.files[0].size>128e3&&(confirm("This image file is larger than 128KB which may result in increased load times. Are you sure you'd like to use this logo?")||(this.value=""))}),e("#ctf_banner").on("change",function(){this.files[0].size>512e3&&(confirm("This image file is larger than 512KB which may result in increased load times. Are you sure you'd like to use this icon?")||(this.value=""))}),e("#ctf_small_icon").on("change",function(){this.files[0].size>32e3&&(confirm("This image file is larger than 32KB which may result in increased load times. Are you sure you'd like to use this icon?")||(this.value=""))}),window.addEventListener("storage",function(t){t.key=="integrations"&&t.newValue&&JSON.parse(t.newValue).name=="mlc"&&(e("#integration-mlc").text("Already Configured").attr("disabled",!0),window.focus(),localStorage.removeItem("integrations"))}),e("#setup-form").submit(function(t){if(e("#newsletter-checkbox").prop("checked")){let i=e(t.target).find("input[name=email]").val();e.ajax({url:"https://newsletters.ctfd.io/lists/ot889gr1sa0e1/subscribe/post-json?c=?",data:{email:i,b_38e27f7d496889133d2214208_d7c3ed71f9:""},dataType:"jsonp",contentType:"application/json; charset=utf-8"})}})});
