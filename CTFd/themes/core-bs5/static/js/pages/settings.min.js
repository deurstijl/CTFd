import"./main.min.js";import{d}from"../utils.min.js";import{C as a}from"../core.min.js";import"../styles.min.js";import"../index.min.js";import"../_commonjsHelpers.min.js";import"../jquery.min.js";import"../dayjs.min.min.js";import"../times.min.js";import"../events.min.js";import"../config.min.js";import"../helpers.min.js";import"../ezq.min.js";import"../patch.min.js";import"../api.min.js";import"../fetch.min.js";const u=o=>`
  <div id="results" class="mb-4">
    <div class="alert alert-danger alert-dismissible fade show position-relative" role="alert">
      <span class="visually-hidden">Error:</span>
      <button type="button" class="btn-close position-absolute top-0 end-0 m-0" data-bs-dismiss="alert" aria-label="Close"></button>
      ${o}
    </div>
  </div>`,p=`
  <div id="results" class="mb-4">
    <div class="alert alert-success alert-dismissible fade show position-relative" role="alert">
      <button type="button" class="btn-close position-absolute top-0 end-0 m-0" data-bs-dismiss="alert" aria-label="Close"></button>
      <strong>Success!</strong> Your profile has been updated
    </div>
  </div>`;function l(o){const s=new FormData(o),n={};for(const[e,t]of s.entries())n[e]=t;return n}function m(o){o.preventDefault();const s=document.getElementById("results");s&&(s.innerHTML="");const n=o.target,e=l(n);e.fields=[];for(const t in e){const r=t.match(/fields\[(\d+)\]/);r&&(e.fields.push({field_id:parseInt(r[1]),value:e[t]}),delete e[t])}a.api.patch_user_private({},e).then(t=>{t.success?s.innerHTML=p:"errors"in t&&Object.entries(t.errors).forEach(([r,c])=>{const i=n.querySelector(`[name='${r}']`);i&&(i.classList.add("input-filled-invalid"),i.classList.remove("input-filled-valid")),s.innerHTML+=u(c)})})}function f(o){o.preventDefault();const s=o.target,n=l(s);a.fetch("/api/v1/tokens",{method:"POST",body:JSON.stringify(n)}).then(e=>e.json()).then(e=>{if(e.success){const t=document.createElement("div");t.innerHTML=`
          <p>Please copy your API Key, it won't be shown again!</p>
          <div class="input-group mb-3">
            <input type="text" id="user-token-result" class="form-control" value="${e.data.value}" readonly>
            <button class="btn btn-outline-secondary" type="button">
              <i class="fas fa-clipboard"></i>
            </button>
          </div>`,t.querySelector("button").addEventListener("click",r=>{d(r,"#user-token-result")}),alert(t.innerHTML)}})}function b(o){o.preventDefault();const s=o.target.closest(".delete-token"),n=s.dataset.tokenId;confirm("Are you sure you want to delete this token?")&&a.fetch(`/api/v1/tokens/${n}`,{method:"DELETE"}).then(e=>e.json()).then(e=>{if(e.success){const t=s.closest(".token-row");t&&t.remove()}})}document.addEventListener("DOMContentLoaded",()=>{var s,n;(s=document.getElementById("user-profile-form"))==null||s.addEventListener("submit",m),(n=document.getElementById("user-token-form"))==null||n.addEventListener("submit",f),document.querySelectorAll(".delete-token").forEach(e=>{e.addEventListener("click",b)}),document.querySelectorAll(".nav-pills a").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const r=e.getAttribute("href");r&&(window.location.hash=r)})});const o=window.location.hash;if(o){const e=o.replace(/[<>\[\]"']/g,""),t=document.querySelector(`.nav-pills a[href='${e}']`);t&&new bootstrap.Tab(t).show()}});
